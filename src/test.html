<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teatro Menu</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.22.9/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
</head>
<body class="bg-gray-900 text-white">
<div id="root"></div>
<script type="text/babel">







  function SectionSelector({ section, setSection, language }) {
    return (
      <div className="flex flex-col md:flex-row justify-center items-center min-h-[80vh] gap-6 px-4">
        <button
          className={`flex flex-col items-center p-6 rounded-lg bg-cover bg-center bg-no-repeat hover:bg-gray-700 transition-colors duration-300 w-full max-w-xs h-48 md:h-64 transform hover:scale-105 transition-transform duration-200 ${
            section === "food" ? "border-4 border-yellow-400" : ""
          }`}
          style={{ backgroundImage: "url('https://images.unsplash.com/photo-1550966871-3ed3cdb5ed0c?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=60')" }}
          onClick={() => setSection("food")}
        >
            <span className="text-lg md:text-xl font-medium text-white bg-gray-900 bg-opacity-50 px-3 py-1 rounded">
              {translations[language].kitchen}
            </span>
        </button>
        <button
          className={`flex flex-col items-center p-6 rounded-lg bg-cover bg-center bg-no-repeat hover:bg-gray-700 transition-colors duration-300 w-full max-w-xs h-48 md:h-64 transform hover:scale-105 transition-transform duration-200 ${
            section === "drinks" ? "border-4 border-yellow-400" : ""
          }`}
          style={{ backgroundImage: "url('https://images.unsplash.com/photo-1514362545857-3bc16c4c7d1b?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=60')" }}
          onClick={() => setSection("drinks")}
        >
            <span className="text-lg md:text-xl font-medium text-white bg-gray-900 bg-opacity-50 px-3 py-1 rounded">
              {translations[language].bar}
            </span>
        </button>
      </div>
    );
  }

  function CategoryNav({ categories, activeCategory, setActiveCategory, section, language }) {
    return (
      <div className="flex overflow-x-auto whitespace-nowrap py-3 sticky top-0 bg-gray-900 z-10">
        {categories.map((category) => (
          <button
            key={category}
            className={`px-3 py-2 mx-1 text-sm md:text-lg font-medium transition-colors duration-300 transform hover:scale-105 ${
              activeCategory === category
                ? "border-b-2 border-yellow-400 text-yellow-400"
                : "text-gray-300 hover:text-yellow-400"
            }`}
            onClick={() => {
              setActiveCategory(category);
              const element = document.getElementById(`${section}-${category}`);
              if (element) {
                window.scrollTo({
                  top: element.offsetTop - 80,
                  behavior: "smooth"
                });
              }
            }}
          >
            {translations[language][category]}
          </button>
        ))}
      </div>
    );
  }

  function MenuItem({ item, language, isFood, addToCart }) {
    return (
      <div className="flex items-center py-3 border-b border-gray-700 rounded-lg transform hover:scale-[1.02] transition-transform duration-200 hover:bg-gray-800">
        <img
          src={item.image}
          alt={item.name[language]}
          className="w-16 h-16 md:w-20 md:h-20 object-cover rounded-lg mr-3"
        />
        <div className="flex-1 pr-2">
          <h3 className="text-lg md:text-xl font-semibold text-yellow-400">{item.name[language]}</h3>
          <p className="text-gray-300 text-sm md:text-base">{item.description[language]}</p>
          <div className="flex justify-between items-center mt-2">
              <span className="text-gray-400 text-sm md:text-base">
                {isFood ? `${item.calories} ${translations[language].calories}` : `${item.volume} ${translations[language].volume}`}
              </span>
            <div className="flex items-center">
                <span className="text-yellow-400 font-bold text-sm md:text-base mr-2">
                  {item.price} {translations[language].price}
                </span>
              <button
                onClick={() => addToCart(item)}
                className="bg-yellow-400 text-gray-900 px-2 py-1 rounded text-sm hover:bg-yellow-500 transform hover:scale-105 transition-transform duration-200"
              >
                {translations[language].addToCart}
              </button>
            </div>
          </div>
        </div>
      </div>
    );
  }

  function MenuSection({ category, items, section, language, addToCart, searchQuery }) {
    const filteredItems = items.filter(
      (item) =>
        item.name[language].toLowerCase().includes(searchQuery.toLowerCase()) ||
        item.description[language].toLowerCase().includes(searchQuery.toLowerCase())
    );

    if (filteredItems.length === 0) return null;

    return (
      <div id={`${section}-${category}`} className="pt-4">
        <h2 className="text-xl md:text-2xl font-bold text-yellow-400 mb-3">{translations[language][category]}</h2>
        {filteredItems.map((item) => (
          <MenuItem key={item.id} item={item} language={language} isFood={section === "food"} addToCart={addToCart} />
        ))}
      </div>
    );
  }

  function App() {
    const [section, setSection] = React.useState(null);
    const [activeCategory, setActiveCategory] = React.useState(null);
    const [language, setLanguage] = React.useState("ru");
    const [searchQuery, setSearchQuery] = React.useState("");
    const [cart, setCart] = React.useState([]);

    const addToCart = (item) => {
      setCart([...cart, item]);
    };

    const removeFromCart = (id) => {
      const index = cart.findIndex((item) => item.id === id);
      if (index !== -1) {
        const newCart = [...cart];
        newCart.splice(index, 1);
        setCart(newCart);
      }
    };

    React.useEffect(() => {
      if (section) {
        setActiveCategory(mockData[section][0].category);
        setSearchQuery("");
      }
    }, [section]);

    React.useEffect(() => {
      if (section) {
        const handleScroll = () => {
          const sections = mockData[section].map((sec) =>
            document.getElementById(`${section}-${sec.category}`)
          );
          const scrollPosition = window.scrollY + 80;

          for (let i = sections.length - 1; i >= 0; i--) {
            if (sections[i] && sections[i].offsetTop <= scrollPosition) {
              setActiveCategory(mockData[section][i].category);
              break;
            }
          }
        };

        window.addEventListener("scroll", handleScroll);
        return () => window.removeEventListener("scroll", handleScroll);
      }
    }, [section]);

    return (
      <div className="max-w-4xl mx-auto px-3 relative">
        <Logo />
        <LanguageSelector language={language} setLanguage={setLanguage} />
        <Cart cart={cart} removeFromCart={removeFromCart} language={language} />
        {!section ? (
          <SectionSelector section={section} setSection={setSection} language={language} />
        ) : (
          <>
            <button
              className="mb-3 text-gray-300 hover:text-yellow-400 text-sm md:text-base transform hover:scale-105 transition-transform duration-200"
              onClick={() => setSection(null)}
            >
              <i className="fas fa-arrow-left mr-2"></i>
              {translations[language].back}
            </button>
            <SearchBar searchQuery={searchQuery} setSearchQuery={setSearchQuery} language={language} />
            <CategoryNav
              categories={mockData[section].map((sec) => sec.category)}
              activeCategory={activeCategory}
              setActiveCategory={setActiveCategory}
              section={section}
              language={language}
            />
            {mockData[section].map((sec) => (
              <MenuSection
                key={sec.category}
                category={sec.category}
                items={sec.items}
                section={section}
                language={language}
                addToCart={addToCart}
                searchQuery={searchQuery}
              />
            ))}
          </>
        )}
      </div>
    );
  }

  ReactDOM.render(<App />, document.getElementById("root"));
</script>
</body>
</html>